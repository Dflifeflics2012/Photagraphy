<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Face Match Gallery</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<script defer src="https://cdn.jsdelivr.net/npm/face-api.js"></script>
<style>
body {
  background: linear-gradient(135deg, #0d0d0d, #1a1a1a);
  color: #fff;
  font-family: 'Orbitron', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px;
}
h1 { color: gold; margin-bottom: 20px; }
input[type="file"] { margin-bottom: 20px; }
#gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 20px;
  width: 100%;
  max-width: 1200px;
}
.card {
  background: linear-gradient(145deg, #222, #111);
  border: 2px solid silver;
  border-radius: 15px;
  text-align: center;
  padding: 10px;
  transition: transform 0.3s;
}
.card img { width: 100%; border-radius: 10px; }
button {
  margin-top: 5px;
  padding: 5px 10px;
  border: none;
  border-radius: 8px;
  background: gold;
  color: black;
  cursor: pointer;
  font-family: 'Orbitron', sans-serif;
  transition: all 0.3s;
}
button:hover { background: silver; color: black; }
</style>
</head>
<body>
<h1>Face Match Gallery</h1>
<input type="file" id="upload" accept="image/*">

<div id="gallery"></div>

<script>
// ====== All 133 images ======
const images = [
"https://drive.google.com/uc?export=view&id=1dTjdmQeqFhzaju0wA8FiyaGA1ymSfD3o",
"https://drive.google.com/uc?export=view&id=16imztI5Nk2ZNx-9ig7GfkSjaoJnkmKci",
"https://drive.google.com/uc?export=view&id=1k5sOKyZSe1GH7jc7svIFj9iL6CSzSBVz",
"https://drive.google.com/uc?export=view&id=1jgtuBoxEcjR7EddLNXNxSuJUNp9qIbmw",
"https://drive.google.com/uc?export=view&id=1Jd23lF89myK1LyPzGSC2wjr5Sqe526qB",
"https://drive.google.com/uc?export=view&id=1TMtPK57PrKpwfb422cXSGSv9nVx25f43",
"https://drive.google.com/uc?export=view&id=1J92CkPA3sRejIsM1fCp-W1Vowq85xgxd",
"https://drive.google.com/uc?export=view&id=1qpqL1429nbUeKZRfwHR3Ky7FZsWLF7FZ",
"https://drive.google.com/uc?export=view&id=1X-5-gJyuBVvgqFf3xNZLaI4iF6qhMR84",
"https://drive.google.com/uc?export=view&id=1eEiVIpJMlsVlg9nzrH5oTZMf4PCuKAD9",
"https://drive.google.com/uc?export=view&id=1oLKF4KjWTWEbNdHw7tCAGwzpvTUlxgqc",
"https://drive.google.com/uc?export=view&id=1oTpTjzWAMHjCYb4Gt7G7iAB-2TbNDoiV",
"https://drive.google.com/uc?export=view&id=14piuuMEFMWMTI0l0CA08335O8SKUl4Jp",
"https://drive.google.com/uc?export=view&id=17p3flv_LaaaoS8KNy1U8QGmqs5kmqsUJ",
"https://drive.google.com/uc?export=view&id=16A4qKkurTNgu_b7s6YjPcJdguMnNyr-q",
"https://drive.google.com/uc?export=view&id=19Wy9rDlh6KhVFeOeXS8_SJJAVVOfMAvz",
"https://drive.google.com/uc?export=view&id=1-AUR91v_9c1RqzuEYejUVkuqAe3yvHoO",
"https://drive.google.com/uc?export=view&id=1rnaWKv7dG1cI8C606Vdyn-PKeNlQvYiq",
"https://drive.google.com/uc?export=view&id=1KqSIOZHr5ajAkyEGtJ41b6b81CXL3Ihe",
"https://drive.google.com/uc?export=view&id=1nmYddZtMZ5JvKwVhRtk-UEJ9dDbnPMx7",
"https://drive.google.com/uc?export=view&id=1QjOxDbqE7JUAMzf3FrtKtCN9zhhTKmPT",
"https://drive.google.com/uc?export=view&id=1tlUSB3qyvSTFu9AOxVp3FDFDnORS5DOC",
"https://drive.google.com/uc?export=view&id=1AJJIeezGRm5k1YST4qjLjPGUNnpWb_XO",
"https://drive.google.com/uc?export=view&id=1hapXnqT26KS09cbCvFtI4xuX_8cb6Ras",
"https://drive.google.com/uc?export=view&id=1t7gwoZYWdmt-aeZqUd1M540I9uddELo5",
"https://drive.google.com/uc?export=view&id=1wGl1jvoB0mQz2vFuiMvF1ZV4PqidsG0I",
"https://drive.google.com/uc?export=view&id=1IN6ykZ5zq8x3XA8CrAdIcIdaRgVqq6nN",
"https://drive.google.com/uc?export=view&id=1BRpm4Iw4GImlhAs7UC1N9dOrPtZa9TMV",
"https://drive.google.com/uc?export=view&id=1f8tLTQESuCXCtKmEe8xtQrr37dP9X2oi",
"https://drive.google.com/uc?export=view&id=1d_XmT2jEfSGEAGB8QQHyTTICaS4wVY1X",
"https://drive.google.com/uc?export=view&id=1OYbuPZU_MvN6vXRkpQY11KeB2xu5RR-E",
"https://drive.google.com/uc?export=view&id=1_HpPKHzG9axp5V16StpvTcUrOKQN8lyd",
"https://drive.google.com/uc?export=view&id=14YPoba4YXCORbmI00PnNl5XSa28cwFGk",
"https://drive.google.com/uc?export=view&id=1mb49iFAtVvUYm9iHKPv1C6Zx308MXddq",
"https://drive.google.com/uc?export=view&id=1QgtToRVlITgUQSb5fGX8_MIeocNurhjT",
"https://drive.google.com/uc?export=view&id=1n8JMLhDvIitah6fui6ugp4-jUs_-gOkZ",
"https://drive.google.com/uc?export=view&id=1JWAlQjhogd0VU_8WJ--86KFgVB8kRgR2",
"https://drive.google.com/uc?export=view&id=11B1A5JOSiJ6ZQiyHM3kCNTEKjMpZaLFc",
"https://drive.google.com/uc?export=view&id=1S77zlOp0FgaKvNY5iGIjUy9wft5vVNFu",
"https://drive.google.com/uc?export=view&id=1isKErUbpnwjLBNJybde8KQ27gXRsS2FK",
"https://drive.google.com/uc?export=view&id=1nBETmfPQGX3zBamV8d7qJq67DHuDZFTa",
"https://drive.google.com/uc?export=view&id=1zLBdwpkEJS7TMSV_vN6mlxrCEfPyy6W1",
"https://drive.google.com/uc?export=view&id=1xo4wGifEZAQf4q5jqaaQkktLaRCCbSHg",
"https://drive.google.com/uc?export=view&id=1KR5Y0bWRYPfgM48ZomXaP8olXFSFtCrP",
"https://drive.google.com/uc?export=view&id=1GLJG6zbXOhX5pe1OQBxr8mDm0qJ2ERfr",
"https://drive.google.com/uc?export=view&id=1H6bSjcBSbQAaO9JOCeHBmX79z6w89mpx",
"https://drive.google.com/uc?export=view&id=1Vlms0bHpazXGifj4pn3v-ThyaqKa7FnK",
"https://drive.google.com/uc?export=view&id=1UXqxSgFuvWCWVpeE1SnvOZeHqaZZ5F2X",
"https://drive.google.com/uc?export=view&id=1BcbfhU36wh0O88FIjwNvAHixm7TKhzm2",
"https://drive.google.com/uc?export=view&id=1rVZVPquxWILxACyWI1th6YbxnzdC9AjN",
"https://drive.google.com/uc?export=view&id=1AwWS-VvAxT11ePV0PR2QHJkMP4v1Or6A",
"https://drive.google.com/uc?export=view&id=1iR3Zh2TR0z46CMVmJeZJE66KkyVN_urn",
"https://drive.google.com/uc?export=view&id=1j9O5NNI1moDV4jfBlYx4OpjG3g-nwJS1",
"https://drive.google.com/uc?export=view&id=1B3FtHlRYssJg7sXz7C9BEdXwvvll1xih",
"https://drive.google.com/uc?export=view&id=1Oe1VXFFHGskaZzh6lhLhVO2-X7FrYins",
"https://drive.google.com/uc?export=view&id=12A8zil9pHp9iwu0cI7OemY0h3ox-yLXU",
"https://drive.google.com/uc?export=view&id=1i-iKAN7r50g93MjvuGdsGfJIPqXLVedn",
"https://drive.google.com/uc?export=view&id=1IdNN0EQljqdbzkZwghEOZf0Wh82ShScn",
"https://drive.google.com/uc?export=view&id=1gTYuqEMTb4KUmahIMQjiaOOt3kPH1zAQ",
"https://drive.google.com/uc?export=view&id=163p4z9yRnw8suRVwQALHsEDot8hz4VVj",
"https://drive.google.com/uc?export=view&id=10iBTct4Fo3FynX8pyD3S6aDyBVbxHcLu",
"https://drive.google.com/uc?export=view&id=1tbPCiOi4YJIKEDdh_8_jLKKVdKPwRuc0",
"https://drive.google.com/uc?export=view&id=1xi9ml0ppgRaEJ7eJtTBXEeRyAkenW7lB",
"https://drive.google.com/uc?export=view&id=17mVj4DqqhZP0R3brWI82vq5ntL9-O0Wv",
"https://drive.google.com/uc?export=view&id=1Hwtwhy_adRkgmiYN0YxAn3wIDsxPlRyI",
"https://drive.google.com/uc?export=view&id=1rUJ8kV3oy0xNmO4kwFLGgmv1EowrhHTW",
"https://drive.google.com/uc?export=view&id=1RtxnJfJRfItVod5UVvKE4znaFk8Ev4JW",
"https://drive.google.com/uc?export=view&id=1GKSVyxal8tgfNzcR0PV4uaucQ5pb-TgS",
"https://drive.google.com/uc?export=view&id=1nImsq2ndzdws9mEAfJkEtNZDjv9z6xCg",
"https://drive.google.com/uc?export=view&id=10gA-0U3XEqgl4ibEojOVUvqvCn9HmrJA",
"https://drive.google.com/uc?export=view&id=14Z80fXxSRMhu3t19Z0lLT_2_J2IUNUIB",
"https://drive.google.com/uc?export=view&id=1Rb7YfCqQnPQcxrKakIdfguqax84NX3Xt",
"https://drive.google.com/uc?export=view&id=1hw1ToPrUJyU8pw9HUPPjRaNjHGSvR6ou",
"https://drive.google.com/uc?export=view&id=1-I93s0ZYXUzXPVOB08wH9jvaT4OOgxrV",
"https://drive.google.com/uc?export=view&id=1KLRuYzthWMYMOCSiBZRYjWcBXGLQkDc9",
"https://drive.google.com/uc?export=view&id=1bjUmOLxwj_p11c-8sBOSpdgEhzRCkL3u",
"https://drive.google.com/uc?export=view&id=1GJjz6KZrSBrzpvglKRHkIrqzTFsqAUHR",
"https://drive.google.com/uc?export=view&id=1aesXdcvLxKBq1U7q7dIGMsQja0vWEIP7",
"https://drive.google.com/uc?export=view&id=17lo05m04chlqrXVl0jrSJQkEG1wpqZLv",
"https://drive.google.com/uc?export=view&id=1MLi0bzNeAyPwBvKuI9wm2K11mrZwQdRg",
"https://drive.google.com/uc?export=view&id=1tYb3xHeQXDu5NbmFj82zd6AHQWdSMPVY",
"https://drive.google.com/uc?export=view&id=1LMp5i2QWHms0soSp7uzx_rC-qNnjVPKs",
"https://drive.google.com/uc?export=view&id=11urwB0q__dgw6swU49hAgC7QxvWZ_l94",
"https://drive.google.com/uc?export=view&id=1BcyXj1TODOkxEnua9cpk_1b2ufXIHTd"
];

// ====== Create card in gallery ======
const gallery = document.getElementById('gallery');
function createCard(url, name){
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <img src="${url}" alt="${name}">
    <div>${name}</div>
    <button onclick="downloadPhoto('${url}')">Download</button>
    <button onclick="requestEdit('${name}')">Request Edit</button>
  `;
  gallery.appendChild(card);
}

function downloadPhoto(url){
  const a = document.createElement('a');
  a.href = url;
  a.download = url.split('/').pop();
  a.click();
}

function requestEdit(name){
  window.location.href = `mailto:Darren.feldman@armyandnavyacademy.org?subject=Edit Request&body=Please edit the photo: ${name}`;
}

// ====== Handle Upload & Match (simplified) ======
document.getElementById('upload').addEventListener('change', async (event) => {
  gallery.innerHTML = '';
  const file = event.target.files[0];
  const uploadedImg = await faceapi.bufferToImage(file);

  await faceapi.nets.tinyFaceDetector.loadFromUri('https://cdn.jsdelivr.net/npm/face-api.js/weights/');
  await faceapi.nets.faceLandmark68Net.loadFromUri('https://cdn.jsdelivr.net/npm/face-api.js/weights/');
  await faceapi.nets.faceRecognitionNet.loadFromUri('https://cdn.jsdelivr.net/npm/face-api.js/weights/');

  const queryDetection = await faceapi.detectSingleFace(uploadedImg).withFaceLandmarks().withFaceDescriptor();
  if(!queryDetection){
    alert("No face detected in uploaded photo.");
    return;
  }

  // Compare to gallery images
  const matches = [];
  for(const url of images){
    const imgEl = await faceapi.fetchImage(url);
    const detection = await faceapi.detectSingleFace(imgEl).withFaceLandmarks().withFaceDescriptor();
    if(detection){
      const distance = faceapi.euclideanDistance(queryDetection.descriptor, detection.descriptor);
      if(distance < 0.6){ // adjust threshold
        matches.push({url, name: url.split('id=')[1]});
      }
    }
  }

  if(matches.length === 0){
    alert("No matches found.");
    return;
  }

  matches.forEach(m => createCard(m.url, m.name));
});
</script>
</body>
</html>
